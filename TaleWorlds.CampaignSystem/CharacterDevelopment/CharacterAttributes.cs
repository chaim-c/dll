using System;
using System.Collections.Generic;
using System.Xml;
using TaleWorlds.Core;
using TaleWorlds.ObjectSystem;

namespace TaleWorlds.CampaignSystem.CharacterDevelopment
{
	// Token: 0x0200034B RID: 843
	public class CharacterAttributes : PropertyOwner<CharacterAttribute>
	{
		// Token: 0x06002FA7 RID: 12199 RVA: 0x000C3E55 File Offset: 0x000C2055
		internal static void AutoGeneratedStaticCollectObjectsCharacterAttributes(object o, List<object> collectedObjects)
		{
			((CharacterAttributes)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002FA8 RID: 12200 RVA: 0x000C3E63 File Offset: 0x000C2063
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002FA9 RID: 12201 RVA: 0x000C3E6C File Offset: 0x000C206C
		public CharacterAttributes()
		{
		}

		// Token: 0x06002FAA RID: 12202 RVA: 0x000C3E74 File Offset: 0x000C2074
		public CharacterAttributes(CharacterAttributes characterAttributes) : base(characterAttributes)
		{
		}

		// Token: 0x06002FAB RID: 12203 RVA: 0x000C3E80 File Offset: 0x000C2080
		public override void Deserialize(MBObjectManager objectManager, XmlNode node)
		{
			this.Initialize();
			foreach (object obj in node.ChildNodes)
			{
				XmlNode xmlNode = (XmlNode)obj;
				if (xmlNode.NodeType != XmlNodeType.Comment)
				{
					XmlAttributeCollection attributes = xmlNode.Attributes;
					string value = attributes["id"].Value;
					string value2 = attributes["value"].Value;
					CharacterAttribute @object = Game.Current.ObjectManager.GetObject<CharacterAttribute>(value);
					if (@object != null)
					{
						int value3 = (value2 != null) ? Convert.ToInt32(value2) : 0;
						base.SetPropertyValue(@object, value3);
					}
				}
			}
			foreach (object obj2 in node.ChildNodes)
			{
				XmlNode xmlNode2 = (XmlNode)obj2;
				if (xmlNode2.NodeType != XmlNodeType.Comment)
				{
					string text = xmlNode2.Name;
					int value4 = 0;
					if (text == "characterAttribute")
					{
						text = null;
						if (xmlNode2.Attributes != null)
						{
							XmlAttribute xmlAttribute = xmlNode2.Attributes["id"];
							if (xmlAttribute != null)
							{
								text = xmlAttribute.InnerText;
							}
						}
					}
					if (text != null)
					{
						CharacterAttribute object2 = Game.Current.ObjectManager.GetObject<CharacterAttribute>(text);
						if (object2 != null)
						{
							XmlAttribute xmlAttribute2 = xmlNode2.Attributes["value"];
							if (xmlAttribute2 != null)
							{
								string value5 = xmlAttribute2.Value;
								value4 = ((value5 != null) ? Convert.ToInt32(value5) : 0);
							}
							base.SetPropertyValue(object2, value4);
						}
					}
				}
			}
		}
	}
}
