using System;
using System.Collections.Generic;
using System.Linq;
using TaleWorlds.CampaignSystem.CharacterDevelopment;
using TaleWorlds.Localization;
using TaleWorlds.SaveSystem;

namespace TaleWorlds.CampaignSystem.LogEntries
{
	// Token: 0x020002E9 RID: 745
	public class PlayerReputationChangesLogEntry : LogEntry
	{
		// Token: 0x06002BA1 RID: 11169 RVA: 0x000B89E6 File Offset: 0x000B6BE6
		internal static void AutoGeneratedStaticCollectObjectsPlayerReputationChangesLogEntry(object o, List<object> collectedObjects)
		{
			((PlayerReputationChangesLogEntry)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
		}

		// Token: 0x06002BA2 RID: 11170 RVA: 0x000B89F4 File Offset: 0x000B6BF4
		protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
		{
			base.AutoGeneratedInstanceCollectObjects(collectedObjects);
			collectedObjects.Add(this._trait);
			collectedObjects.Add(this._companionsInParty);
			collectedObjects.Add(this._referenceHero);
		}

		// Token: 0x06002BA3 RID: 11171 RVA: 0x000B8A21 File Offset: 0x000B6C21
		internal static object AutoGeneratedGetMemberValue_trait(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._trait;
		}

		// Token: 0x06002BA4 RID: 11172 RVA: 0x000B8A2E File Offset: 0x000B6C2E
		internal static object AutoGeneratedGetMemberValue_companionsInParty(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._companionsInParty;
		}

		// Token: 0x06002BA5 RID: 11173 RVA: 0x000B8A3B File Offset: 0x000B6C3B
		internal static object AutoGeneratedGetMemberValue_note(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._note;
		}

		// Token: 0x06002BA6 RID: 11174 RVA: 0x000B8A4D File Offset: 0x000B6C4D
		internal static object AutoGeneratedGetMemberValue_referenceHero(object o)
		{
			return ((PlayerReputationChangesLogEntry)o)._referenceHero;
		}

		// Token: 0x06002BA7 RID: 11175 RVA: 0x000B8A5A File Offset: 0x000B6C5A
		public PlayerReputationChangesLogEntry(TraitObject trait, Hero referenceHero, ActionNotes note)
		{
			this._trait = trait;
			this._referenceHero = referenceHero;
			this._companionsInParty = Hero.MainHero.CompanionsInParty.ToList<Hero>();
			this._note = note;
		}

		// Token: 0x06002BA8 RID: 11176 RVA: 0x000B8A8C File Offset: 0x000B6C8C
		public override void GetConversationScoreAndComment(Hero talkTroop, bool findString, out string comment, out ImportanceEnum score)
		{
			score = ImportanceEnum.Zero;
			comment = "";
			if (this._companionsInParty.Contains(talkTroop))
			{
				if (talkTroop.GetTraitLevel(DefaultTraits.Honor) > 0 && this._trait == DefaultTraits.Honor)
				{
					if (this._note == ActionNotes.QuestSuccess)
					{
						MBTextManager.SetTextVariable("COMMENT_REFERENCE_HERO", this._referenceHero.Name, false);
						comment = "str_comment_companion_on_honor_for_quest_success";
						score = ImportanceEnum.SomewhatImportant;
					}
					else if (this._note == ActionNotes.QuestBetrayal)
					{
						MBTextManager.SetTextVariable("COMMENT_REFERENCE_HERO", this._referenceHero.Name, false);
						comment = "str_comment_companion_on_honor_for_quest_betrayal";
						score = ImportanceEnum.SomewhatImportant;
					}
				}
				if (talkTroop.GetTraitLevel(DefaultTraits.Generosity) > 0 && this._trait == DefaultTraits.Generosity && this._note == ActionNotes.PartyTakenCareOf)
				{
					comment = "str_comment_companion_on_generosity_for_party_morale";
					score = ImportanceEnum.SomewhatImportant;
				}
			}
		}

		// Token: 0x06002BA9 RID: 11177 RVA: 0x000B8B58 File Offset: 0x000B6D58
		public override string ToString()
		{
			return "PlayerReputationChangesLogEntry";
		}

		// Token: 0x04000D17 RID: 3351
		[SaveableField(410)]
		private readonly TraitObject _trait;

		// Token: 0x04000D18 RID: 3352
		[SaveableField(411)]
		private readonly List<Hero> _companionsInParty;

		// Token: 0x04000D19 RID: 3353
		[SaveableField(412)]
		private readonly ActionNotes _note;

		// Token: 0x04000D1A RID: 3354
		[SaveableField(413)]
		private readonly Hero _referenceHero;
	}
}
